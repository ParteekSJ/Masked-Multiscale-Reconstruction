#!/usr/bin/env python3import torchdef each_patch_loss_function(a, b):    cos_loss = torch.nn.CosineSimilarity()    loss = 0    for item in range(len(a)):        a_tem = a[item].permute(0, 2, 3, 1)        b_tem = b[item].permute(0, 2, 3, 1)        loss += torch.mean(            1            - cos_loss(                a_tem.contiguous().view(-1, a_tem.shape[-1]),                b_tem.contiguous().view(-1, b_tem.shape[-1]),            )        )    return loss